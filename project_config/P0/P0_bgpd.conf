! -*- bgp -*-
!
! BGP configuration file
!
hostname bgpd
password zebra
!
router bgp 65001
bgp router-id 1.0.0.0
no bgp default ipv4-unicast


! 
    
    
    neighbor fde4:1::1 remote-as 65001
        neighbor fde4:1::1 password P0P1
    
    

    address-family ipv6 unicast
        neighbor fde4:1::1 activate
            neighbor fde4:1::1 next-hop-self
            neighbor fde4:1::1 update-source fde4:1::

    exit-address-family


! 
    
    
    neighbor fde4:1:200::2 remote-as 65001
        neighbor fde4:1:200::2 password P0LUX0
    
    

    address-family ipv6 unicast
        neighbor fde4:1:200::2 activate
            neighbor fde4:1:200::2 next-hop-self
            neighbor fde4:1:200::2 route-reflector-client
            neighbor fde4:1:200::2 update-source fde4:1::

    exit-address-family


! 
    
    
    neighbor fde4:1:200::3 remote-as 65001
        neighbor fde4:1:200::3 password P0LUX1
    
    

    address-family ipv6 unicast
        neighbor fde4:1:200::3 activate
            neighbor fde4:1:200::3 next-hop-self
            neighbor fde4:1:200::3 route-reflector-client
            neighbor fde4:1:200::3 update-source fde4:1::

    exit-address-family


! 
    
    
    neighbor fde4:1:400::4 remote-as 65001
        neighbor fde4:1:400::4 password P0NAM0
    
    

    address-family ipv6 unicast
        neighbor fde4:1:400::4 activate
            neighbor fde4:1:400::4 next-hop-self
            neighbor fde4:1:400::4 route-reflector-client
            neighbor fde4:1:400::4 update-source fde4:1::

    exit-address-family


! 
    
    
    neighbor fde4:1:400::5 remote-as 65001
        neighbor fde4:1:400::5 password P0NAM1
    
    

    address-family ipv6 unicast
        neighbor fde4:1:400::5 activate
            neighbor fde4:1:400::5 next-hop-self
            neighbor fde4:1:400::5 route-reflector-client
            neighbor fde4:1:400::5 update-source fde4:1::

    exit-address-family


! 
    
    
    neighbor fde4:1:600::6 remote-as 65001
        neighbor fde4:1:600::6 password P0LG0
    
    

    address-family ipv6 unicast
        neighbor fde4:1:600::6 activate
            neighbor fde4:1:600::6 next-hop-self
            neighbor fde4:1:600::6 route-reflector-client
            neighbor fde4:1:600::6 update-source fde4:1::

    exit-address-family


! 
    
    
    neighbor fde4:1:600::7 remote-as 65001
        neighbor fde4:1:600::7 password P0LG1
    
    

    address-family ipv6 unicast
        neighbor fde4:1:600::7 activate
            neighbor fde4:1:600::7 next-hop-self
            neighbor fde4:1:600::7 route-reflector-client
            neighbor fde4:1:600::7 update-source fde4:1::

    exit-address-family


! 
    
    
    neighbor fde4:1:800::8 remote-as 65001
        neighbor fde4:1:800::8 password P0BW0
    
    

    address-family ipv6 unicast
        neighbor fde4:1:800::8 activate
            neighbor fde4:1:800::8 next-hop-self
            neighbor fde4:1:800::8 route-reflector-client
            neighbor fde4:1:800::8 update-source fde4:1::

    exit-address-family


! 
    
    
    neighbor fde4:1:800::9 remote-as 65001
        neighbor fde4:1:800::9 password P0BW1
    
    

    address-family ipv6 unicast
        neighbor fde4:1:800::9 activate
            neighbor fde4:1:800::9 next-hop-self
            neighbor fde4:1:800::9 route-reflector-client
            neighbor fde4:1:800::9 update-source fde4:1::

    exit-address-family


! 
    
    
    neighbor fde4::1 remote-as 64512
        neighbor fde4::1 interface P0-eth5
    
    

    address-family ipv6 unicast
        neighbor fde4::1 activate
                network fde4:1::/32

                neighbor fde4::1 route-map garbage in

    exit-address-family



! 
    
    
    neighbor fde4:2:1::2:bace remote-as 65002
        neighbor fde4:2:1::2:bace interface P0-eth6
    
    

    address-family ipv6 unicast
        neighbor fde4:2:1::2:bace activate
                network fde4:1::/32
                neighbor fde4:2:1::2:bace prefix-list provider-65002-out out

                neighbor fde4:2:1::2:bace route-map provider in

    exit-address-family


            ip prefix-list provider-65002-out permit fde4:1::/32
            ip prefix-list provider-65002-out permit fde4:3::/32
            ip prefix-list provider-65002-out permit fde4:9::/32


    bgp community-list standard garbage permit 64512:100
    bgp community-list standard customer permit 101:1
    bgp community-list standard provider permit 101:2
    bgp community-list standard sharedCost permit 101:3
    !
    route-map garbage permit 10
        set ip next-hop ::1
        set local-preference 10
        set community additive no-export
    route-map  garbage permit 20
    !
    route-map customer permit 10
        call rm-community-in
        on-match next
    route-map customer permit 20
        set local-preference 100
    !
    route-map rm-community-in permit 10
        match community garbage
        call garbage
    route-map rm-community-in permit 20
    !
    route-map provider permit 10
        set local-preference 10
    route-map provider permit 20
    !
    route-map sharedCost permit 10
        set local-preference 50
    route-map sharedCost permit 20
    !

