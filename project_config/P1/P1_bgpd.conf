! -*- bgp -*-
!
! BGP configuration file
!
hostname bgpd
password zebra
!
router bgp 65001
bgp router-id 1.1.1.1
no bgp default ipv4-unicast


! 
    
    
    neighbor fde4:1:: remote-as 65001
        neighbor fde4:1:: password P0P1
    
    

    address-family ipv6 unicast
        neighbor fde4:1:: activate
            neighbor fde4:1:: next-hop-self
            neighbor fde4:1:: update-source fde4:1::1

    exit-address-family


! 
    
    
    neighbor fde4:1:200::2 remote-as 65001
        neighbor fde4:1:200::2 password P1LUX0
    
    

    address-family ipv6 unicast
        neighbor fde4:1:200::2 activate
            neighbor fde4:1:200::2 next-hop-self
            neighbor fde4:1:200::2 route-reflector-client
            neighbor fde4:1:200::2 update-source fde4:1::1

    exit-address-family


! 
    
    
    neighbor fde4:1:200::3 remote-as 65001
        neighbor fde4:1:200::3 password P1LUX1
    
    

    address-family ipv6 unicast
        neighbor fde4:1:200::3 activate
            neighbor fde4:1:200::3 next-hop-self
            neighbor fde4:1:200::3 route-reflector-client
            neighbor fde4:1:200::3 update-source fde4:1::1

    exit-address-family


! 
    
    
    neighbor fde4:1:400::4 remote-as 65001
        neighbor fde4:1:400::4 password P1NAM0
    
    

    address-family ipv6 unicast
        neighbor fde4:1:400::4 activate
            neighbor fde4:1:400::4 next-hop-self
            neighbor fde4:1:400::4 route-reflector-client
            neighbor fde4:1:400::4 update-source fde4:1::1

    exit-address-family


! 
    
    
    neighbor fde4:1:400::5 remote-as 65001
        neighbor fde4:1:400::5 password P1NAM1
    
    

    address-family ipv6 unicast
        neighbor fde4:1:400::5 activate
            neighbor fde4:1:400::5 next-hop-self
            neighbor fde4:1:400::5 route-reflector-client
            neighbor fde4:1:400::5 update-source fde4:1::1

    exit-address-family


! 
    
    
    neighbor fde4:1:600::6 remote-as 65001
        neighbor fde4:1:600::6 password P1LG0
    
    

    address-family ipv6 unicast
        neighbor fde4:1:600::6 activate
            neighbor fde4:1:600::6 next-hop-self
            neighbor fde4:1:600::6 route-reflector-client
            neighbor fde4:1:600::6 update-source fde4:1::1

    exit-address-family


! 
    
    
    neighbor fde4:1:600::7 remote-as 65001
        neighbor fde4:1:600::7 password P1LG1
    
    

    address-family ipv6 unicast
        neighbor fde4:1:600::7 activate
            neighbor fde4:1:600::7 next-hop-self
            neighbor fde4:1:600::7 route-reflector-client
            neighbor fde4:1:600::7 update-source fde4:1::1

    exit-address-family


! 
    
    
    neighbor fde4:1:800::8 remote-as 65001
        neighbor fde4:1:800::8 password P1BW0
    
    

    address-family ipv6 unicast
        neighbor fde4:1:800::8 activate
            neighbor fde4:1:800::8 next-hop-self
            neighbor fde4:1:800::8 route-reflector-client
            neighbor fde4:1:800::8 update-source fde4:1::1

    exit-address-family


! 
    
    
    neighbor fde4:1:800::9 remote-as 65001
        neighbor fde4:1:800::9 password P1BW1
    
    

    address-family ipv6 unicast
        neighbor fde4:1:800::9 activate
            neighbor fde4:1:800::9 next-hop-self
            neighbor fde4:1:800::9 route-reflector-client
            neighbor fde4:1:800::9 update-source fde4:1::1

    exit-address-family


! 
    
    
    neighbor fde4:5:3000:1::5 remote-as 65005
        neighbor fde4:5:3000:1::5 password ASes6500165005
        neighbor fde4:5:3000:1::5 interface P1-eth5
    
    

    address-family ipv6 unicast
        neighbor fde4:5:3000:1::5 activate
                network fde4:1::/32
                neighbor fde4:5:3000:1::5 prefix-list peer-65005-out out

                neighbor fde4:5:3000:1::5 route-map sharedCost in

    exit-address-family


            ip prefix-list peer-65005-out permit fde4:1::/32
            ip prefix-list peer-65005-out permit fde4:9::/32
            ip prefix-list peer-65005-out permit fde4:3::/32


    bgp community-list standard garbage permit 64512:100
    bgp community-list standard customer permit 101:1
    bgp community-list standard provider permit 101:2
    bgp community-list standard sharedCost permit 101:3
    !
    route-map garbage permit 10
        set ip next-hop ::1
        set local-preference 5
        set community additive no-export
    route-map  garbage permit 20
    !
    route-map customer permit 10
        call rm-community-in
        on-match next
    route-map customer permit 20
        set local-preference 100
    route-map customer permit 30
    !
    route-map rm-community-in permit 10
        match community garbage
        call garbage
    route-map rm-community-in permit 20
    !
    route-map provider permit 10
        set local-preference 10
    route-map provider permit 20
    !
    route-map sharedCost permit 10
        set local-preference 50
    route-map sharedCost permit 20
    !

